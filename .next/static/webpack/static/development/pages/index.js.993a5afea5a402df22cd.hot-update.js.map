{"version":3,"file":"static/webpack/static/development/pages/index.js.993a5afea5a402df22cd.hot-update.js","sources":["webpack:///./components/Messenger.js"],"sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport io from 'socket.io-client';\nimport { addMessage } from '../actions/message';\nimport { addHouse } from '../actions/message';\nimport Message from './Message';\nimport NavBar from './NavBar';\n\nconst generateName = () => {\n  const getRandomInt = (min, max) =>\n    Math.floor(Math.random() * (max - min)) + min;\n  const firstName = [\n    'Jack',\n    'Steven',\n    'Brian',\n    'Marc',\n    'Drew',\n    'Stephanie',\n    'Daniel',\n    'James',\n    'Spencer',\n    'Caitlin',\n    'Jackie',\n    'Julius',\n    'Patrick',\n  ];\n  const lastName = [\n    'Li',\n    'Chung',\n    'Tiosejo',\n    'Louie',\n    'Curtis',\n    'Sockwell',\n    'Jiang',\n    'Bykowsky',\n    'Detro',\n    'Chen',\n    'Sea',\n    'Doyle',\n  ];\n  const name =\n    firstName[getRandomInt(0, firstName.length)] +\n    ' ' +\n    lastName[getRandomInt(0, lastName.length)];\n  return name\n};\n\nclass Messenger extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      text: '',\n      messages: [],\n      username: generateName(),\n      updated: false,\n      currentConvo: '',\n      friends: new Set(),\n      currentView: 'messenger'\n    }\n  }\n\n  componentDidUpdate() {\n    this.scrollToBottom();\n    if (!this.state.messages.length && !this.state.updated) {\n      this.setState(state => {\n        this.props.messages.forEach(msg => {\n          state.friends.add(msg.username);\n        });\n        return state;\n      });\n      const filtered = this.state.currentConvo !== '' ? this.props.messages.filter(message => (message.username === this.state.currentConvo)) : this.props.messages;\n      this.setState({ messages: filtered, updated: true })\n    }\n  }\n\n  componentDidMount() {\n    this.socket = io('http://localhost:3000');\n    this.socket.on('message', this.handleMessage);\n    setTimeout(this.scrollToBottom, 100);\n  }\n\n  componentWillUnmount() {\n    this.socket.off('message', this.handleMessage);\n    this.socket.close()\n  }\n\n  handleMessage = message => {\n    this.setState(state => state.friends.add(message.username));\n    this.setState(state => ({ messages: state.messages.concat(message) }));\n    this.props.addMessage(message.text, message.username, message.created_at)\n  };\n\n  getCurrentConvo = otherUser => {\n\n    this.setState(state => {\n      const filtered = this.props.messages.filter(message => (message.username === otherUser));\n      return {\n        currentConvo: otherUser,\n        messages: filtered,\n      }\n    });\n  };\n\n  handleSubmit = e => {\n    e.preventDefault();\n\n    const message = {\n      created_at: new Date().getTime(),\n      username: this.state.username,\n      text: this.state.text,\n    };\n\n    this.socket.emit('message', message);\n\n    this.props.addMessage(\n      this.state.text,\n      this.state.username,\n      message.created_at,\n    );\n    this.setState(state => ({\n      text: '',\n      messages: this.state.messages.concat(message),\n    }))\n  };\n\n  changeToHomeView = () => {\n    //TODO change this to routing? if so remove currentView from state\n    this.setState({currentView: 'browse'})\n  };\n\n  changeToMessageView = () => {\n    //TODO remove this with above function\n    this.setState({currentView: 'messenger'})\n  };\n\n  scrollToBottom = () => {\n    if (this.el) {\n      this.el.scrollIntoView({ behavior: 'instant' })\n    }\n  };\n\n  handleChange = e => {\n    this.setState({ username: e.target.value })\n  };\n\n  render() {\n    const sameUser = (msg, i, arr) => {\n      return i > 0 && msg.username === arr[i - 1].username\n    };\n\n    return (\n      <React.Fragment>\n\n        <input\n          type=\"text\"\n          onChange={this.handleChange}\n          placeholder={'enter username'}\n        />\n        <div className=\"mdl-card mdl-shadow--2dp\" id=\"chatview\">\n          <NavBar\n            getConvo={this.getCurrentConvo}\n            friends={[...this.state.friends]}\n            changeHome={this.changeToHomeView}\n            changeMessage={this.changeToMessageView}\n            currentView={this.state.currentView}\n          />\n          {this.state.currentView === 'browser' && <ul>Browse Homes</ul>}\n          {this.state.currentView === 'messenger' && <ul>\n            {this.state.messages.map((message, i, array) => (\n              <Message\n                key={i}\n                message={message}\n                username={this.state.username}\n                firstMessage={sameUser(message, i, array)}\n              />\n            ))}\n            <div\n              ref={el => {\n                this.el = el;\n              }}\n            />\n          </ul>}\n          <form onSubmit={this.handleSubmit} autoComplete=\"off\">\n            <div className=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label\">\n              <input\n                type=\"text\"\n                value={this.state.text}\n                onChange={e => this.setState({ text: e.target.value })}\n                className=\"mdl-textfield__input\"\n                id=\"message-input\"\n                placeholder={'Send a message'}\n              />\n              <label className=\"mdl-textfield__label\" htmlFor=\"message-input\" />\n            </div>\n          </form>\n          <style>{`\n\t\t\t\t\t\t#message-input {\n\t\t\t\t\t\tborder-bottom: lightgray solid 1px;\n\t\t\t\t\t\tborder-top: lightgray solid 1px;\n\t\t\t\t\t\theight: 20px;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tform {\n\t\t\t\t\t\t\tbackground: #fff;\n\t\t\t\t\t\t\tpadding: 0px 10px 0px 10px;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tul {\n\t\t\t\t\t\t\theight: 480px;\n\t\t\t\t\t\t\tmargin: 0;\n\t\t\t\t\t\t\tpadding: 0;\n\t\t\t\t\t\t\ttext-align: left;\n\t\t\t\t\t\t\tlist-style: none;\n\t\t\t\t\t\t\toverflow-y: scroll;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tul li {\n\t\t\t\t\t\t\tpadding: 1px;\n\t\t\t\t\t\t\tbackground: #FFF;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t.mdl-card {\n\t\t\t\t\t\t\tmargin: auto;\n\t\t\t\t\t\t\ttransition: all .3s;\n\t\t\t\t\t\t\ttransform: translateY(100px);\n              height: 500px;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t.mdl-textfield {\n\t\t\t\t\t\t\tpadding: 28px 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t.timestamp{\n\t\t          font-size:10px;\n\t\t          font-weight: 300;\n\t\t          color: transparent;\n\t\t          margin: 3px;\n\t          }\n\t          li:hover .my-timestamp {\n\t\t          color: black;\n\t\t          transition: color .8s;\n\t          }\n\t          li:hover .timestamp {\n\t\t          color: black;\n\t\t          transition: color .8s;\n\t          }\n\t        .my-message {\n\t\t        display: inline-block;\n\t\t        background: #00e34d;\n\t\t        color: white;\n\t\t        border-radius: 10px;\n\t\t        padding: 7px;\n\t\t        max-width: 50%;\n\t\t        word-wrap: break-word;\n\t\t        clear: right;\n\t\t        line-height: 1.25;\n\t        }\n\t        .your-message {\n\t\t        display: inline-block;\n\t\t        background: #E5E5EA;\n\t\t        border-radius: 10px;\n\t\t        padding: 7px;\n\t\t        word-wrap: break-word;\n\t\t        max-width:70%;\n\t\t        line-height: 1.25;\n\t        }\n          .message-username {\n\t          display: block;\n\t          font-size: 0.8em;\n\t          font-weight: bold;\n\t          line-height: 1.5;\n\t          margin-left: 0.6em;\n          }\n\t\t\t\t\t`}</style>\n        </div>\n      </React.Fragment>\n    )\n  }\n}\n\nexport default connect(\n  ({ messages, houses }) => ({ messages, houses }),\n  { addMessage , addHouse},\n)(Messenger)\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAeA;AAcA;AAIA;AACA;AACA;AACA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AAuCA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AA3CA;AA8CA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAtDA;AAwDA;AAEA;AACA;AACA;AACA;AAHA;AACA;AAKA;AACA;AACA;AACA;AAIA;AAAA;AACA;AACA;AAFA;AAAA;AAIA;AACA;AA5EA;AA8EA;AACA;AAAA;AAAA;AACA;AACA;AAjFA;AAmFA;AACA;AAAA;AAAA;AACA;AACA;AAtFA;AAwFA;AACA;AAAA;AAAA;AACA;AACA;AACA;AA5FA;AA8FA;AAAA;AAAA;AACA;AACA;AA9FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAFA;AAWA;AACA;;;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;;;AAEA;AACA;AACA;AACA;AACA;;;AAEA;AACA;AACA;AACA;;;AA6DA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AASA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AA4EA;;;;AAhOA;AACA;AAkOA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;;;;A","sourceRoot":""}